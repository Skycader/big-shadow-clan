<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Клан Большой Тени - Агенты</title>
    <link rel="stylesheet" href="all.min.css" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --base03: #002b36;
        --base02: #073642;
        --base01: #586e75;
        --base00: #657b83;
        --base0: #839496;
        --base1: #93a1a1;
        --base2: #eee8d5;
        --base3: #fdf6e3;

        --yellow: #b58900;
        --orange: #cb4b16;
        --red: #dc322f;
        --magenta: #d33682;
        --violet: #6c71c4;
        --blue: #268bd2;
        --cyan: #2aa198;
        --green: #859900;

        --primary: var(--base03);
        --secondary: var(--base02);
        --accent: var(--yellow);
        --text: var(--base1);
        --text-muted: var(--base00);
        --border: var(--base01);
        --success: var(--green);
        --danger: var(--red);
        --warning: var(--orange);
        --skill-bg: var(--base02);
        --skill-hover: var(--base01);
        --rank-bg: rgba(181, 137, 0, 0.15);
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--primary);
        color: var(--text);
        line-height: 1.6;
        min-height: 100vh;
      }

      .header {
        background: var(--secondary);
        padding: 20px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid var(--accent);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        cursor: pointer;
      }

      .header-title {
        font-size: 2.2em;
        font-weight: 900;
        letter-spacing: 2px;
        color: var(--accent);
        text-shadow: 0 0 10px rgba(181, 137, 0, 0.3);
      }

      .header-controls {
        display: flex;
        align-items: center;
        gap: 25px;
      }

      .balance-container {
        display: flex;
        align-items: center;
        gap: 10px;
        background: linear-gradient(135deg, var(--accent), var(--yellow));
        padding: 15px 25px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(181, 137, 0, 0.4);
      }

      .balance-container:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(181, 137, 0, 0.6);
      }

      .balance-label {
        font-size: 0.95em;
        color: var(--base03);
        font-weight: 600;
      }

      .balance-value {
        font-size: 2.2em;
        font-weight: 900;
        color: var(--base03);
        text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        min-width: 80px;
        text-align: center;
      }

      .balance-years {
        font-size: 1em;
        color: var(--base03);
        font-weight: 600;
      }

      .header-icon {
        width: 45px;
        height: 45px;
        background: var(--secondary);
        border: 2px solid var(--accent);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent);
        font-size: 1.3em;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
      }

      .header-icon:hover {
        background: var(--accent);
        color: var(--base03);
        transform: rotate(15deg) scale(1.1);
        box-shadow: 0 5px 15px rgba(181, 137, 0, 0.5);
      }

      .header-icon.export {
        background: var(--green);
        color: white;
        border-color: var(--green);
      }
      .header-icon.export:hover {
        background: var(--success);
      }
      .header-icon.import {
        background: var(--blue);
        color: white;
        border-color: var(--blue);
      }
      .header-icon.import:hover {
        background: var(--cyan);
      }
      .header-icon.copy {
        background: var(--cyan);
        color: white;
        border-color: var(--cyan);
      }
      .header-icon.copy:hover {
        background: var(--blue);
      }

      .container {
        max-width: 1400px;
        margin: 30px auto;
        padding: 0 20px;
      }

      .agents-table {
        width: 100%;
        border-collapse: collapse;
        background: var(--secondary);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        margin-bottom: 30px;
      }

      .agents-table th {
        background: linear-gradient(
          135deg,
          var(--accent) 0%,
          var(--yellow) 100%
        );
        padding: 15px;
        text-align: left;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.9em;
        color: var(--base03);
      }

      .agents-table tr {
        border-bottom: 1px solid var(--border);
      }

      .agents-table td {
        padding: 12px 15px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .agents-table tr:hover {
        background: rgba(181, 137, 0, 0.1);
      }

      .agents-table tr:last-child td {
        border-bottom: none;
      }

      .agents-table td:first-child {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .agent-avatar {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: var(--base01);
        object-fit: cover;
        border: 2px solid var(--accent);
      }

      .status {
        display: inline-block;
        border-radius: 20px;
        padding: 0px 5px;
        font-size: 0.85em;
        font-weight: 600;
        text-transform: uppercase;
      }

      .status.waiting {
        background: var(--blue);
        color: white;
      }

      .status.active {
        background: var(--green);
        color: white;
      }

      .rank-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        text-align: center;
      }

      .rank {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 90px;
      }

      .rank-name {
        font-size: 1.1em;
        font-weight: 600;
        color: var(--yellow);
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .rank-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 8px;
        background: var(--rank-bg);
        font-size: 1em;
        font-weight: 700;
        color: var(--yellow);
        line-height: 1.4;
        white-space: pre-line;
        text-align: center;
        min-width: 60px;
      }

      .add-agent-btn {
        display: block;
        width: 250px;
        margin: 20px auto;
        padding: 15px 30px;
        background: linear-gradient(
          135deg,
          var(--accent) 0%,
          var(--yellow) 100%
        );
        color: var(--base03);
        border: none;
        border-radius: 50px;
        font-size: 1.1em;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(181, 137, 0, 0.4);
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      .add-agent-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(181, 137, 0, 0.6);
      }

      .add-agent-btn:active {
        transform: translateY(1px);
      }

      .profile-container {
        display: none;
        max-width: 1300px;
        margin: 30px auto;
        background: var(--secondary);
        border-radius: 15px;
        padding: 40px;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6);
        border: 2px solid var(--accent);
      }

      .profile-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid var(--border);
        position: relative;
      }

      .profile-title {
        font-size: 2.5em;
        font-weight: 700;
        color: var(--accent);
      }

      .back-btn {
        padding: 12px 30px;
        background: linear-gradient(135deg, var(--accent), var(--yellow));
        color: var(--base03);
        border: none;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 700;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 1.1em;
        box-shadow: 0 3px 10px rgba(181, 137, 0, 0.3);
      }

      .back-btn:hover {
        background: linear-gradient(135deg, var(--yellow), #d7af00);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(181, 137, 0, 0.5);
      }

      .delete-btn {
        padding: 12px 30px;
        background: linear-gradient(135deg, var(--danger), #a12a26);
        color: white;
        border: none;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 700;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 1.1em;
        box-shadow: 0 3px 10px rgba(220, 53, 69, 0.4);
      }

      .delete-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(220, 53, 69, 0.6);
      }

      .copy-btn {
        width: 45px;
        height: 45px;
        background: linear-gradient(135deg, var(--cyan), var(--blue));
        border: 2px solid var(--cyan);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.2em;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-left: 15px;
        box-shadow: 0 3px 10px rgba(42, 161, 152, 0.3);
      }

      .copy-btn:hover {
        background: linear-gradient(135deg, var(--blue), #1e6bb8);
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(42, 161, 152, 0.5);
      }

      .profile-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        margin-bottom: 40px;
      }

      .profile-left {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 25px;
      }

      .profile-avatar-container {
        position: relative;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .profile-avatar-container:hover {
        transform: scale(1.05);
      }

      .profile-avatar-container::after {
        content: "✎";
        position: absolute;
        bottom: 10px;
        right: 10px;
        width: 40px;
        height: 40px;
        background: var(--accent);
        color: var(--base03);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2em;
        font-weight: 700;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .profile-avatar-container:hover::after {
        opacity: 1;
      }

      .profile-avatar {
        width: 240px;
        height: 240px;
        border-radius: 50%;
        object-fit: cover;
        border: 5px solid var(--accent);
        background: var(--base01);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transition: all 0.3s ease;
      }

      .profile-avatar-editable {
        position: absolute;
        inset: 0;
        border-radius: 50%;
        background: rgba(181, 137, 0, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5em;
        font-weight: 600;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .profile-avatar-container:hover .profile-avatar-editable {
        opacity: 1;
      }

      .profile-rank-container {
        text-align: center;
        background: var(--rank-bg);
        padding: 15px 30px;
        border-radius: 10px;
        border: 2px solid var(--accent);
        width: 100%;
        box-shadow: 0 4px 15px rgba(181, 137, 0, 0.2);
      }

      .profile-rank-title {
        font-size: 1.1em;
        font-weight: 600;
        color: var(--yellow);
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .profile-rank-badge {
        font-size: 2.5em;
        line-height: 1.4;
        font-weight: 900;
        color: var(--accent);
        white-space: pre-line;
        text-align: center;
      }

      .profile-info {
        display: flex;
        flex-direction: column;
        gap: 25px;
        width: 100%;
      }

      .info-group {
        margin-bottom: 20px;
      }

      .info-label {
        display: block;
        margin-bottom: 10px;
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.95em;
      }

      .info-input {
        width: 100%;
        padding: 14px 18px;
        background: var(--skill-bg);
        border: 2px solid var(--border);
        border-radius: 10px;
        color: var(--text);
        font-size: 1.2em;
        transition: all 0.3s ease;
      }

      .info-input:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 15px rgba(181, 137, 0, 0.4);
      }

      .info-select {
        width: 100%;
        padding: 14px 18px;
        background: var(--skill-bg);
        border: 2px solid var(--border);
        border-radius: 10px;
        color: var(--text);
        font-size: 1.2em;
        appearance: none;
        background-image: url("image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23839496' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 15px center;
        background-size: 20px;
      }

      .profile-description {
        background: var(--skill-bg);
        border: 2px solid var(--border);
        border-radius: 10px;
        padding: 20px;
        width: 100%;
        height: 100%;
        min-height: 500px;
        font-size: 1.1em;
        line-height: 1.7;
        resize: vertical;
        color: var(--text);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
      }

      .profile-description:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 15px rgba(181, 137, 0, 0.4);
      }

      .level-info {
        background: var(--skill-bg);
        border: 2px solid var(--border);
        border-radius: 10px;
        padding: 20px;
        text-align: center;
      }

      .level-label {
        display: block;
        font-size: 0.95em;
        color: var(--text-muted);
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .level-value {
        font-size: 3.5em;
        font-weight: 900;
        color: var(--text);
        text-shadow: 0 0 15px rgba(181, 137, 0, 0.5);
      }

      .skills-container {
        margin-top: 20px;
        grid-column: 1 / -1;
      }

      .skills-header {
        font-size: 2em;
        font-weight: 700;
        margin-bottom: 25px;
        color: var(--accent);
        text-align: center;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--border);
      }

      .skills-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        gap: 20px;
      }

      .skill-item {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        background: var(--skill-bg);
        padding: 20px;
        border-radius: 10px;
        border: 1px solid var(--border);
        transition: all 0.3s ease;
      }

      .skill-item:hover {
        background: var(--skill-hover);
        transform: translateX(5px);
        border-color: var(--accent);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .skill-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border);
      }

      .skill-name {
        font-weight: 700;
        font-size: 1.15em;
        color: var(--text);
      }

      .skill-level {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .level-btn {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, var(--accent), var(--yellow));
        color: var(--base03);
        border: none;
        border-radius: 50%;
        font-size: 1.4em;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 3px 10px rgba(181, 137, 0, 0.3);
      }

      .level-btn:hover {
        background: linear-gradient(135deg, var(--yellow), #d7af00);
        transform: scale(1.15);
        box-shadow: 0 5px 15px rgba(181, 137, 0, 0.5);
      }

      .level-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
        background: var(--base01);
        color: var(--base00);
        box-shadow: none;
      }

      .current-level {
        font-size: 1.8em;
        font-weight: 900;
        min-width: 50px;
        text-align: center;
        color: var(--accent);
      }

      .skill-description {
        flex-grow: 1;
        font-size: 0.95em;
        color: var(--text-muted);
        line-height: 1.6;
        margin-top: 12px;
        font-style: italic;
      }

      .skill-level-desc {
        margin-top: 12px;
        padding: 10px 14px;
        background: rgba(181, 137, 0, 0.08);
        border-left: 4px solid var(--accent);
        border-radius: 6px;
        font-size: 0.95em;
        line-height: 1.5;
        color: var(--text);
        white-space: pre-line;
      }

      .skill-progress {
        margin-top: 10px;
        background: var(--base01);
        border-radius: 5px;
        height: 10px;
        overflow: hidden;
      }

      .skill-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--accent), var(--yellow));
        transition: width 0.3s ease;
      }

      .skill-progress-label {
        font-size: 0.8em;
        color: var(--text-muted);
        text-align: right;
        margin-top: 5px;
      }

      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        background: var(--secondary);
        padding: 45px;
        border-radius: 20px;
        border: 3px solid var(--accent);
        max-width: 550px;
        width: 90%;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.7);
      }

      .modal-title {
        font-size: 2em;
        margin-bottom: 25px;
        color: var(--accent);
        text-align: center;
        text-shadow: 0 0 10px rgba(181, 137, 0, 0.3);
      }

      .modal-input {
        width: 100%;
        padding: 14px 18px;
        margin-bottom: 25px;
        background: var(--skill-bg);
        border: 2px solid var(--border);
        border-radius: 10px;
        color: var(--text);
        font-size: 1.2em;
        transition: all 0.3s ease;
      }

      .modal-input:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 15px rgba(181, 137, 0, 0.4);
      }

      .modal-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        margin-top: 25px;
      }

      .modal-btn {
        padding: 14px 35px;
        border: none;
        border-radius: 35px;
        font-weight: 700;
        font-size: 1.1em;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1.5px;
      }

      .modal-confirm {
        background: linear-gradient(135deg, var(--success), var(--green));
        color: white;
        box-shadow: 0 4px 15px rgba(133, 153, 0, 0.4);
      }

      .modal-cancel {
        background: linear-gradient(135deg, var(--danger), #a12a26);
        color: white;
        box-shadow: 0 4px 15px rgba(220, 50, 47, 0.4);
      }

      .modal-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 7px 20px rgba(0, 0, 0, 0.5);
      }

      .empty-state {
        text-align: center;
        padding: 80px 20px;
        color: var(--text-muted);
      }

      .empty-state p {
        font-size: 1.3em;
        margin-top: 20px;
      }

      .file-input {
        display: none;
      }

      .notification {
        position: fixed;
        top: 25px;
        right: 25px;
        padding: 18px 30px;
        background: linear-gradient(135deg, var(--success), var(--green));
        color: white;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        z-index: 2000;
        transform: translateX(500px);
        transition:
          transform 0.4s ease,
          opacity 0.4s ease;
        font-size: 1.1em;
        font-weight: 600;
        letter-spacing: 0.5px;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification.error {
        background: linear-gradient(135deg, var(--danger), #a12a26);
      }

      @media (max-width: 1024px) {
        .profile-content {
          grid-template-columns: 1fr;
        }

        .skills-grid {
          grid-template-columns: 1fr;
        }

        .profile-avatar {
          width: 200px;
          height: 200px;
        }
      }

      @media (max-width: 768px) {
        .header-title {
          font-size: 1.6em;
        }

        .balance-value {
          font-size: 1.8em;
        }

        .header {
          padding: 15px 20px;
          flex-direction: column;
          gap: 15px;
        }

        .header-controls {
          width: 100%;
          justify-content: space-between;
        }

        .agents-table {
          font-size: 0.85em;
        }

        .agents-table th,
        .agents-table td {
          padding: 8px 10px;
        }

        .agent-avatar {
          width: 30px;
          height: 30px;
        }

        .profile-container {
          padding: 25px;
          margin: 20px;
        }

        .profile-avatar {
          width: 160px;
          height: 160px;
        }

        .profile-rank-badge {
          font-size: 1.8em;
        }

        .level-value {
          font-size: 2.8em;
        }

        .skills-grid {
          grid-template-columns: 1fr;
        }

        .header-icon {
          width: 40px;
          height: 40px;
          font-size: 1.1em;
        }

        .back-btn,
        .delete-btn {
          padding: 10px 20px;
          font-size: 1em;
        }

        .profile-description {
          min-height: 300px;
        }
      }

      /* Вкладки */
      #tabs-container {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin: 0 auto 30px;
        max-width: 1400px;
        padding: 0 20px;
        flex-wrap: wrap;
      }

      .tab {
        padding: 12px 28px;
        font-size: 1.05em;
        font-weight: 600;
        color: var(--text);
        background: var(--secondary);
        border: 2px solid var(--border);
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.25s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
      }

      .tab:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 18px rgba(181, 137, 0, 0.35);
        border-color: var(--accent);
      }

      .tab.active {
        background: linear-gradient(135deg, var(--accent), var(--yellow));
        color: var(--base03);
        border-color: var(--yellow);
        box-shadow: 0 5px 20px rgba(181, 137, 0, 0.5);
        transform: translateY(-1px);
      }

      /* Главный заголовок (Навыки агента / Разработка Терминатора) */
      .skills-header {
        font-size: 2.2em;
        font-weight: 700;
        color: var(--accent);
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--border);
      }

      /* Контейнер каждой главы */
      .chapter-container {
        margin-bottom: 40px;
      }

      /* Заголовок главы (меньше главного, но в том же стиле) */
      .chapter-header {
        font-size: 1.8em;
        font-weight: 700;
        color: var(--yellow);
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border);
      }

      /* Подгрид для карточек навыков внутри главы */
      .perks-grid {
        display: grid;
        grid-template-columns: repeat(
          auto-fill,
          minmax(380px, 1fr)
        ); /* как у тебя было в .skills-grid */
        gap: 20px;
      }

      /* Убедись, что основной .skills-grid остаётся флексом/гридом только для глав */
      #skillsGrid {
        display: block; /* или flex column, чтобы главы шли друг под другом */
      }
    </style>
  </head>
  <body>
    <div class="header" id="header">
      <div class="header-title">Клан Большой Тени</div>
      <div class="header-controls">
        <div class="balance-container" id="balanceContainer">
          <span class="balance-value" id="totalBalance">0</span>
        </div>
        <a
          href="#"
          class="header-icon export"
          id="exportBtn"
          title="Экспорт данных"
        >
          <i class="fas fa-file-export"></i>
        </a>
        <a
          href="#"
          class="header-icon import"
          id="importBtn"
          title="Импорт данных"
        >
          <i class="fas fa-file-import"></i>
        </a>
      </div>
    </div>

    <div class="container">
      <div id="main-view">
        <table class="agents-table" id="agentsTable">
          <thead>
            <tr>
              <th>Агент</th>
              <th>Звание</th>
              <th>Уровень</th>
              <th>Статус</th>
            </tr>
          </thead>
          <tbody id="agentsBody">
            <!-- Agents will be populated here -->
          </tbody>
        </table>

        <button class="add-agent-btn" id="addAgentBtn">+</button>
      </div>

      <div id="profile-view" class="profile-container">
        <div class="profile-header">
          <div>
            <h2 class="profile-title" id="profileName">Имя агента</h2>
            <button class="back-btn" id="backBtn">← Назад</button>
          </div>
          <div style="display: flex; gap: 15px">
            <button class="copy-btn" id="copyBtn" title="Копировать данные">
              <i class="fas fa-copy"></i>
            </button>
            <button
              class="copy-btn"
              id="deleteAgentBtn"
              title="Удалить агента"
              style="
                background: linear-gradient(135deg, var(--danger), #a12a26);
                border-color: var(--danger);
              "
            >
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        </div>

        <div class="profile-content">
          <div class="profile-left">
            <div class="profile-avatar-container" id="avatarContainer">
              <img
                src=""
                alt="Агент"
                class="profile-avatar"
                id="profileAvatar"
              />
              <div class="profile-avatar-editable"></div>
            </div>

            <div class="profile-rank-container">
              <div class="profile-rank-title" id="agentRankTitle">Звание</div>
              <div class="profile-rank-badge" id="agentRankBadge">◽️</div>
            </div>

            <div class="profile-info">
              <div class="info-group">
                <label class="info-label">Имя агента</label>
                <input
                  type="text"
                  class="info-input"
                  id="agentName"
                  placeholder="Введите имя"
                />
              </div>

              <div class="info-group">
                <label class="info-label">Статус</label>
                <select class="info-select" id="agentStatus">
                  <option value="waiting">Ожидание</option>
                  <option value="active">Выполняет миссию</option>
                </select>
              </div>

              <div class="level-info">
                <span class="level-label">УРОВЕНЬ</span>
                <div class="level-value" id="agentLevel">0</div>
              </div>
            </div>
          </div>

          <div class="profile-right">
            <div class="info-group" style="width: 100%; height: 100%">
              <label class="info-label">Описание</label>
              <textarea
                class="profile-description"
                id="agentDescription"
                placeholder="Описание агента"
              ></textarea>
            </div>
          </div>
        </div>

        <div class="skills-container">
          <div class="skills-grid" id="skillsGrid">
            <!-- Skills will be populated here -->
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="addAgentModal">
      <div class="modal-content">
        <h3 class="modal-title">Добавить нового агента</h3>
        <input
          type="text"
          class="modal-input"
          id="newAgentName"
          placeholder="Введите имя агента"
          required
        />
        <input
          type="text"
          class="modal-input"
          id="newAgentPhoto"
          placeholder="URL фото (необязательно)"
        />
        <textarea
          class="modal-input"
          id="newAgentDescription"
          placeholder="Описание агента (необязательно)"
          rows="4"
        ></textarea>
        <div class="modal-buttons">
          <button class="modal-btn modal-confirm" id="confirmAddAgent">
            Добавить
          </button>
          <button class="modal-btn modal-cancel" id="cancelAddAgent">
            Отмена
          </button>
        </div>
      </div>
    </div>

    <div class="modal" id="editBalanceModal">
      <div class="modal-content">
        <h3 class="modal-title">Редактировать общий баланс</h3>
        <p
          style="
            text-align: center;
            margin-bottom: 20px;
            color: var(--text);
            font-size: 1.1em;
          "
        >
          Введите значение для изменения баланса:<br />
          <small style="color: var(--text-muted); font-size: 0.95em">
            Положительное — добавить, отрицательное — вычесть
          </small>
        </p>
        <input
          type="number"
          class="modal-input"
          id="balanceChangeValue"
          placeholder="0"
          step="1"
        />
        <div class="modal-buttons">
          <button class="modal-btn modal-confirm" id="confirmBalanceEdit">
            Применить
          </button>
          <button class="modal-btn modal-cancel" id="cancelBalanceEdit">
            Отмена
          </button>
        </div>
      </div>
    </div>

    <div class="modal" id="deleteAgentModal">
      <div class="modal-content">
        <h3 class="modal-title">Удалить агента?</h3>
        <p>Вы действительно хотите <strong>навсегда</strong> удалить:</p>
        <p
          style="
            font-size: 1.4em;
            font-weight: bold;
            color: var(--danger);
            text-align: center;
            margin: 20px 0;
          "
          id="deleteAgentNameDisplay"
        ></p>
        <p style="text-align: center; color: var(--text-muted)">
          Это действие нельзя отменить.
        </p>
        <div class="modal-buttons">
          <button class="modal-btn modal-confirm" id="confirmDeleteAgent">
            Удалить
          </button>
          <button class="modal-btn modal-cancel" id="cancelDeleteAgent">
            Отмена
          </button>
        </div>
      </div>
    </div>

    <div class="notification" id="notification"></div>

    <input type="file" id="fileInput" class="file-input" accept=".json" />
    <script src="data/agents.js"></script>
    <script src="data/terminator.js"></script>
    <script src="data/stands.js"></script>
    <script>
      const GAME_DATA = [AGENTS_DATA, TERMINATOR_DATA, STAND_DATA];

      // ==================== DOM ====================

      const agentsBody = document.getElementById("agentsBody");
      const addAgentBtn = document.getElementById("addAgentBtn");
      const addAgentModal = document.getElementById("addAgentModal");
      const confirmAddAgent = document.getElementById("confirmAddAgent");
      const cancelAddAgent = document.getElementById("cancelAddAgent");
      const newAgentName = document.getElementById("newAgentName");
      const newAgentPhoto = document.getElementById("newAgentPhoto");
      const newAgentDescription = document.getElementById(
        "newAgentDescription",
      );
      const profileView = document.getElementById("profile-view");
      const mainView = document.getElementById("main-view");
      const backBtn = document.getElementById("backBtn");
      const agentNameInput = document.getElementById("agentName");
      const agentDescriptionInput = document.getElementById("agentDescription");
      const agentStatusSelect = document.getElementById("agentStatus");
      const agentRankTitle = document.getElementById("agentRankTitle");
      const agentRankBadge = document.getElementById("agentRankBadge");
      const agentLevelDisplay = document.getElementById("agentLevel");
      const skillsGrid = document.getElementById("skillsGrid");
      const totalBalanceDisplay = document.getElementById("totalBalance");
      const balanceContainer = document.getElementById("balanceContainer");
      const exportBtn = document.getElementById("exportBtn");
      const importBtn = document.getElementById("importBtn");
      const fileInput = document.getElementById("fileInput");
      const editBalanceModal = document.getElementById("editBalanceModal");
      const balanceChangeValue = document.getElementById("balanceChangeValue");
      const confirmBalanceEdit = document.getElementById("confirmBalanceEdit");
      const cancelBalanceEdit = document.getElementById("cancelBalanceEdit");
      const header = document.getElementById("header");
      const copyBtn = document.getElementById("copyBtn");
      const profileAvatar = document.getElementById("profileAvatar");
      const profileName = document.getElementById("profileName");
      const avatarContainer = document.getElementById("avatarContainer");
      const notification = document.getElementById("notification");
      const deleteAgentModal = document.getElementById("deleteAgentModal");
      const confirmDeleteAgent = document.getElementById("confirmDeleteAgent");
      const cancelDeleteAgent = document.getElementById("cancelDeleteAgent");
      const deleteAgentNameDisplay = document.getElementById(
        "deleteAgentNameDisplay",
      );
      const deleteAgentBtn = document.getElementById("deleteAgentBtn");

      let currentAgentId = null;
      let currentAgentData = null;
      let isAutoSaving = false;
      let holdInterval = null;
      let agentToDeleteId = null;
      let currentTab = 0;

      // Динамически создать вкладки
      const tabsContainer = document.createElement("div");
      tabsContainer.id = "tabs-container";

      GAME_DATA.forEach((tabConfig, index) => {
        const tabBtn = document.createElement("button");
        tabBtn.className = "tab" + (index === currentTab ? " active" : "");
        tabBtn.textContent = tabConfig.tabName || `Вкладка ${index + 1}`;

        tabBtn.addEventListener("click", () => {
          document
            .querySelectorAll(".tab")
            .forEach((btn) => btn.classList.remove("active"));
          tabBtn.classList.add("active");
          switchTab(index);
        });

        tabsContainer.appendChild(tabBtn);
      });

      document
        .querySelector(".container")
        .insertBefore(tabsContainer, mainView);

      // ==================== STORAGE HELPERS ====================

      const STORAGE_KEY = "clan-big-shadow-data";

      function getAllData() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return { totalBalance: 0, tabs: {} };
          const parsed = JSON.parse(raw);
          return {
            totalBalance: Number(parsed.totalBalance) || 0,
            tabs:
              parsed.tabs && typeof parsed.tabs === "object" ? parsed.tabs : {},
          };
        } catch {
          return { totalBalance: 0, tabs: {} };
        }
      }

      function saveAllData(data) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      }

      function getTabData(tab) {
        const all = getAllData();
        const key = String(tab);
        if (!all.tabs[key]) {
          all.tabs[key] = { agents: [] };
          saveAllData(all);
        }
        return all.tabs[key];
      }

      function updateTab(tab, updater) {
        const all = getAllData();
        const key = String(tab);
        if (!all.tabs[key]) all.tabs[key] = { agents: [] };
        all.tabs[key] = updater(all.tabs[key]);
        saveAllData(all);
      }

      function updateBalance(newBalance) {
        const all = getAllData();
        all.totalBalance = Math.max(0, Number(newBalance) || 0);
        saveAllData(all);
        loadTotalBalance();
      }

      // ==================== ИНИЦИАЛИЗАЦИЯ ====================

      loadAgents();
      loadTotalBalance();
      setupEventListeners();

      function switchTab(tabIndex) {
        currentTab = tabIndex;
        Array.from(tabsContainer.children).forEach((btn, i) => {
          btn.style.background =
            i === tabIndex ? "var(--accent)" : "var(--secondary)";
        });
        if (profileView.style.display === "block") {
          profileView.style.display = "none";
          mainView.style.display = "block";
        }
        loadAgents();
        loadTotalBalance();
      }

      function loadTotalBalance() {
        const { totalBalance } = getAllData();
        totalBalanceDisplay.textContent = totalBalance;
      }

      function saveBalanceChange() {
        const change = parseInt(balanceChangeValue.value);
        if (isNaN(change)) {
          showNotification("Введите число", "error");
          return;
        }

        const { totalBalance } = getAllData();
        const newBalance = totalBalance + change;

        if (newBalance < 0) {
          showNotification("Баланс не может быть отрицательным", "error");
          return;
        }

        updateBalance(newBalance);
        editBalanceModal.style.display = "none";
        showNotification(`Баланс изменён на ${change > 0 ? "+" : ""}${change}`);
      }

      function exportDatabase() {
        const data = getAllData();
        const exportPayload = {
          ...data,
          exportedAt: new Date().toISOString(),
          version: "1.0",
        };

        const blob = new Blob([JSON.stringify(exportPayload, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `clan-big-shadow-full-${new Date().toISOString().slice(0, 10)}.json`;
        a.click();
        URL.revokeObjectURL(url);
        showNotification("Все данные экспортированы");
      }

      function importDatabase(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (ev) => {
          try {
            const imported = JSON.parse(ev.target.result);
            if (
              !imported ||
              typeof imported.totalBalance !== "number" ||
              !imported.tabs
            ) {
              showNotification(
                "Неверный формат файла (ожидается totalBalance и tabs)",
                "error",
              );
              return;
            }

            // минимальная очистка
            Object.values(imported.tabs).forEach((tab) => {
              if (!tab.agents || !Array.isArray(tab.agents)) tab.agents = [];
            });

            saveAllData({
              totalBalance: Math.max(0, Number(imported.totalBalance)),
              tabs: imported.tabs,
            });

            showNotification("Данные импортированы");
            loadTotalBalance();
            loadAgents();
          } catch (err) {
            showNotification("Ошибка импорта: " + err.message, "error");
          }
        };
        reader.readAsText(file);
        fileInput.value = "";
      }

      function loadAgents() {
        const tabData = getTabData(currentTab);
        const agents = tabData.agents || [];
        agentsBody.innerHTML = "";

        if (agents.length === 0) {
          agentsBody.innerHTML = `<tr><td colspan="4" class="empty-state"><p>Нет агентов</p><p>Добавьте первого агента</p></td></tr>`;
          return;
        }

        agents.sort((a, b) => b.level - a.level);

        agents.forEach((agent) => {
          const photo =
            agent.photo ||
            "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg==";
          const statusClass = agent.status || "waiting";
          const config = GAME_DATA[currentTab];
          const rankObj = config.ranks.find((r) => r.name === agent.rank) || {
            badge: "◽️",
          };

          const tr = document.createElement("tr");
          tr.innerHTML = `
      <td>
        <img src="${photo}" class="agent-avatar" alt="${agent.name}"
             onerror="this.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg=='">
        <span>${agent.name}</span>
      </td>
      <td><div class="rank"><div class="rank-name">${agent.rank}</div><div class="rank-badge">${rankObj.badge}</div></div></td>
      <td>${agent.level}</td>
      <td><span class="status ${statusClass}">${statusClass === "waiting" ? "Ожидание" : "Выполняет миссию"}</span></td>
    `;
          tr.addEventListener("click", () => openAgentProfile(agent.id));
          agentsBody.appendChild(tr);
        });
      }

      function addNewAgent() {
        const name = newAgentName.value.trim();
        if (!name) {
          showNotification("Введите имя", "error");
          return;
        }

        const config = GAME_DATA[currentTab];
        const agentSkills = {};

        config.skills.forEach((chapter) => {
          chapter.perks.forEach((perk) => {
            agentSkills[perk.id] = 0;
          });
        });

        const agent = {
          id: Date.now().toString(),
          name,
          photo: newAgentPhoto.value.trim() || "",
          description: newAgentDescription.value.trim() || "Новый агент клана",
          skills: agentSkills,
          level: 0,
          rank: config.ranks[0].name,
          status: "waiting",
          createdAt: new Date().toISOString(),
        };

        updateTab(currentTab, (data) => ({
          ...data,
          agents: [...(data.agents || []), agent],
        }));

        addAgentModal.style.display = "none";
        loadAgents();
        showNotification("Агент добавлен");
      }

      function openAgentProfile(id) {
        const tabData = getTabData(currentTab);
        const agent = (tabData.agents || []).find((a) => a.id === id);
        if (!agent) return;

        currentAgentId = id;
        currentAgentData = { ...agent };

        agentNameInput.value = agent.name;
        agentDescriptionInput.value = agent.description || "";
        agentStatusSelect.value = agent.status || "waiting";

        const config = GAME_DATA[currentTab];
        agentRankTitle.textContent = agent.rank;
        agentRankBadge.textContent =
          config.ranks.find((r) => r.name === agent.rank)?.badge || "◽️";
        agentLevelDisplay.textContent = agent.level;

        profileAvatar.src =
          agent.photo ||
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg==";
        profileName.textContent = agent.name;

        renderSkills();

        mainView.style.display = "none";
        profileView.style.display = "block";
      }

      function renderSkills() {
        skillsGrid.innerHTML = "";

        const config = GAME_DATA[currentTab];
        const agentSkills = currentAgentData.skills || {};

        const mainHeader = document.createElement("div");
        mainHeader.className = "skills-header";
        mainHeader.textContent = config.treeTitle || "Навыки";
        skillsGrid.appendChild(mainHeader);

        config.skills.forEach((chapter) => {
          const chapterContainer = document.createElement("div");
          chapterContainer.className = "chapter-container";

          const chapterHeader = document.createElement("div");
          chapterHeader.className = "chapter-header";
          chapterHeader.innerHTML = `<h3>${chapter.chapterTitle}</h3>`;
          chapterContainer.appendChild(chapterHeader);

          const perksGrid = document.createElement("div");
          perksGrid.className = "perks-grid";

          chapter.perks.forEach((skill) => {
            const level = agentSkills[skill.id] || 0;
            const maxLevel = config.maxLevelPerSkill;
            const progress = (Math.min(level, maxLevel) / maxLevel) * 100;

            let levelText = "";
            const desc = config.skillLevelDescriptions?.[skill.id];
            if (desc && level >= 1 && level <= maxLevel) {
              levelText = desc[level] || "";
            }

            const item = document.createElement("div");
            item.className = "skill-item";
            item.innerHTML = `
        <div class="skill-header">
          <span class="skill-name">${skill.name}</span>
          <div class="skill-level">
            <button class="level-btn ${level < 1 ? "disabled" : ""}" data-skill="${skill.id}" data-action="decrease">-</button>
            <span class="current-level">${level}</span>
            <button class="level-btn ${level >= maxLevel ? "disabled" : ""}" data-skill="${skill.id}" data-action="increase">+</button>
          </div>
        </div>
        <div class="skill-description">${skill.description}</div>
        ${levelText ? `<div class="skill-level-desc">${levelText}</div>` : ""}
        <div class="skill-progress">
          <div class="skill-progress-bar" style="width:${progress}%"></div>
        </div>
        <div class="skill-progress-label">${Math.min(level, maxLevel)}/${maxLevel}</div>
      `;
            perksGrid.appendChild(item);
          });

          chapterContainer.appendChild(perksGrid);
          skillsGrid.appendChild(chapterContainer);
        });

        document.querySelectorAll(".level-btn").forEach((btn) => {
          btn.addEventListener("click", handleSkillChange);
          btn.addEventListener("mousedown", startHold);
          btn.addEventListener("mouseup", stopHold);
          btn.addEventListener("mouseleave", stopHold);
        });
      }

      function startHold(e) {
        if (e.target.classList.contains("disabled")) return;
        const skill = e.target.dataset.skill;
        const action = e.target.dataset.action;
        changeSkillLevel(skill, action);
        holdInterval = setInterval(() => changeSkillLevel(skill, action), 200);
      }

      function stopHold() {
        clearInterval(holdInterval);
      }

      function changeSkillLevel(skillId, action) {
        const level = currentAgentData.skills[skillId] || 0;
        const config = GAME_DATA[currentTab];
        const maxLevel = config.maxLevelPerSkill;
        const costBase = config.costBase;

        const all = getAllData();
        let balance = all.totalBalance;
        let changed = false;

        if (action === "increase" && level < maxLevel) {
          const cost = (level + 1) * costBase;
          if (balance >= cost) {
            balance -= cost;
            currentAgentData.skills[skillId] = level + 1;
            changed = true;
          } else {
            showNotification("Недостаточно OE", "error");
          }
        } else if (action === "decrease" && level > 0) {
          const refund = level * costBase;
          balance += refund;
          currentAgentData.skills[skillId] = level - 1;
          changed = true;
        }

        if (changed) {
          updateBalance(balance);
          recalculateAgentStats();

          updateTab(currentTab, (data) => {
            const agents = [...(data.agents || [])];
            const idx = agents.findIndex((a) => a.id === currentAgentId);
            if (idx !== -1) agents[idx] = { ...currentAgentData };
            return { ...data, agents };
          });

          renderSkills();
          autoSaveAgent();
        }
      }

      function handleSkillChange(e) {
        if (e.target.classList.contains("disabled")) return;
        const { skill, action } = e.target.dataset;
        changeSkillLevel(skill, action);
      }

      function recalculateAgentStats() {
        let total = 0;
        Object.values(currentAgentData.skills).forEach((v) => (total += v));
        currentAgentData.level = total;

        const config = GAME_DATA[currentTab];
        const rank = config.ranks.find(
          (r) => total >= r.minLevel && total <= r.maxLevel,
        );
        currentAgentData.rank = rank ? rank.name : config.ranks[0].name;

        agentLevelDisplay.textContent = total;
        agentRankTitle.textContent = currentAgentData.rank;
        agentRankBadge.textContent = rank ? rank.badge : "◽️";
      }

      function editAvatar() {
        const url = prompt("URL фотографии:", currentAgentData.photo || "");
        if (url !== null) {
          currentAgentData.photo = url.trim();
          profileAvatar.src =
            url.trim() ||
            "https://via.placeholder.com/240/073642/839496?text=???";
          autoSaveAgent();
        }
      }

      function autoSaveAgent() {
        if (isAutoSaving || !currentAgentId) return;
        isAutoSaving = true;

        currentAgentData.name = agentNameInput.value.trim();
        currentAgentData.description = agentDescriptionInput.value.trim();
        currentAgentData.status = agentStatusSelect.value;

        updateTab(currentTab, (data) => {
          const agents = [...(data.agents || [])];
          const idx = agents.findIndex((a) => a.id === currentAgentId);
          if (idx !== -1) {
            agents[idx] = { ...currentAgentData };
          }
          return { ...data, agents };
        });

        profileName.textContent = currentAgentData.name;

        setTimeout(() => (isAutoSaving = false), 400);
      }

      function copyAgentData() {
        const data = {
          name: currentAgentData.name,
          description: currentAgentData.description,
          skills: currentAgentData.skills,
          level: currentAgentData.level,
          rank: currentAgentData.rank,
        };
        navigator.clipboard
          .writeText(JSON.stringify(data, null, 2))
          .then(() => showNotification("Данные скопированы"))
          .catch(() => showNotification("Ошибка копирования", "error"));
      }

      function showNotification(msg, type = "success") {
        notification.textContent = msg;
        notification.className =
          "notification" + (type === "error" ? " error" : "");
        notification.classList.add("show");
        setTimeout(() => notification.classList.remove("show"), 3200);
      }

      function setupEventListeners() {
        addAgentBtn.addEventListener("click", () => {
          newAgentName.value = "";
          newAgentPhoto.value = "";
          newAgentDescription.value = "";
          addAgentModal.style.display = "flex";
        });

        confirmAddAgent.addEventListener("click", addNewAgent);
        cancelAddAgent.addEventListener(
          "click",
          () => (addAgentModal.style.display = "none"),
        );

        backBtn.addEventListener("click", () => {
          profileView.style.display = "none";
          mainView.style.display = "block";
          loadAgents();
        });

        balanceContainer.addEventListener("click", () => {
          balanceChangeValue.value = "";
          editBalanceModal.style.display = "flex";
        });

        confirmBalanceEdit.addEventListener("click", saveBalanceChange);
        cancelBalanceEdit.addEventListener(
          "click",
          () => (editBalanceModal.style.display = "none"),
        );

        exportBtn.addEventListener("click", exportDatabase);
        importBtn.addEventListener("click", () => fileInput.click());
        fileInput.addEventListener("change", importDatabase);

        header.addEventListener("click", () => {
          if (profileView.style.display === "block") {
            profileView.style.display = "none";
            mainView.style.display = "block";
            loadAgents();
          }
        });

        copyBtn.addEventListener("click", copyAgentData);
        avatarContainer.addEventListener("click", editAvatar);

        agentNameInput.addEventListener("input", autoSaveAgent);
        agentDescriptionInput.addEventListener("input", autoSaveAgent);
        agentStatusSelect.addEventListener("change", autoSaveAgent);

        deleteAgentBtn.addEventListener("click", () => {
          if (!currentAgentId) return;
          const tabData = getTabData(currentTab);
          const agent = (tabData.agents || []).find(
            (a) => a.id === currentAgentId,
          );
          if (agent) {
            agentToDeleteId = currentAgentId;
            deleteAgentNameDisplay.textContent = agent.name;
            deleteAgentModal.style.display = "flex";
          }
        });

        confirmDeleteAgent.addEventListener("click", () => {
          if (!agentToDeleteId) return;

          updateTab(currentTab, (data) => ({
            ...data,
            agents: (data.agents || []).filter((a) => a.id !== agentToDeleteId),
          }));

          showNotification("Агент удалён");
          deleteAgentModal.style.display = "none";
          profileView.style.display = "none";
          mainView.style.display = "block";
          loadAgents();
          agentToDeleteId = null;
        });

        cancelDeleteAgent.addEventListener("click", () => {
          deleteAgentModal.style.display = "none";
          agentToDeleteId = null;
        });
      }
    </script>
  </body>
</html>
